The MEF-enabled output window adapter was created based on the excellent post of Sam: 
http://blog.280z28.org/archives/2009/11/79/
